<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Toolkits for Couterparts</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
		<link href="/images/favicon.ico" rel="icon" type="image/x-icon" />
		<style>
			p {
				position: absolute;
				top: 50%;
				left: 50%;
				margin-right: -50%;
				transform: translate(-50%, -50%);
				font-family: Arial;
				font-size: 12px;
			}
			a.code {
				position: fixed;
				bottom: 10px;
				right: 10px;
				font-family: Arial;
				font-size: 12px;
			}
		</style>
	</head>

	<body>
		<script src="js/three-r97.min.js"></script>
		<!-- <script src="../build/three.js"></script> -->
		<script src="js/Detector.js"></script>
		<script src="js/OBJLoader.js"></script>
		<script src="js/OrbitControls.js"></script>
		<script src="js/stats.min.js"></script>
		<script src="js/THREEx.WindowResize.js"></script>
		<!-- <script src="js/THREEx.FullScreen.js"></script> -->
		<script src="js/WebGL.js"></script>
		<script src="js/onEvent.js"></script>

		<!-- <div id="ThreeJS" style="position: absolute; left:0px; top:0px"></div> -->
		<div class="three-d">
			<div id="ThreeJS"></div>
			<p><span id="Loader"></span></p>
			<div class="three-bg"></div>
		</div>

		<script>
			// custom global variables

			var objects = []

			var container, scene, threeCamera, renderer, controls

			init()
			animate()

			function init() {
				// scene

				camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 80000)
				camera.position.z = 850

				scene = new THREE.Scene()
				scene.background = null // transparent

				var threeOnEvent = new THREE.onEvent(scene, camera)

				var ambient = new THREE.AmbientLight(0x101030)
				scene.add(ambient)

				// model

				var manager = new THREE.LoadingManager()
				manager.onProgress = function(item, loaded, total) {
					console.log(item, loaded, total)
				}

				var onProgress = function(xhr) {
					if (xhr.lengthComputable) {
						var percentComplete = (xhr.loaded / xhr.total) * 100
						if (percentComplete < 100) {
							var downloaded = "Loading: " + Math.round(percentComplete, 2) + "%"
						} else {
							var downloaded = " "
						}
						document.getElementById("Loader").innerHTML = downloaded
					}
				}

				var onError = function(xhr) {}

				var texture = new THREE.Texture()
				var loader = new THREE.ImageLoader(manager)
				loader.load("images/texture.png", function(image) {
					texture.image = image
					texture.needsUpdate = true
				})

				var loader = new THREE.OBJLoader(manager)
				loader.load(
					"toolkit/toolkit.obj",
					function(object) {
						object.traverse(function(child) {
							if (child instanceof THREE.Mesh) {
								child.material.map = texture
								child.material.side = THREE.DoubleSide
							}
						})

						object.position.y = 0
						object.position.x = 0
						object.scale.x = 150
						object.scale.y = 150
						object.scale.z = 150
						scene.add(object)

						if (window.innerWidth <= 1000) {
							object.scene.rotation.z = 1.6
							camera.position.z = 750
							camera.position.x = -20
						}
					},
					onProgress,
					onError
				)

				// render model

				renderer = new THREE.WebGLRenderer({ alpha: true })
				if (!Detector.webgl) console.log(`ðŸ˜” no webgl`)

				renderer.setClearColor(0x000000, 0)

				renderer.setPixelRatio(2)
				renderer.setSize(innerWidth, innerHeight)

				container = document.getElementById("ThreeJS")
				container.appendChild(renderer.domElement)
				window.addEventListener("resize", onWindowResize, false)

				THREEx.WindowResize(renderer, threeCamera)

				// events

				THREEx.WindowResize(renderer, camera)
				// THREEx.FullScreen.bindKey({ charCode: "m".charCodeAt(0) })

				// controls

				controls = new THREE.OrbitControls(camera, renderer.domElement)
				controls.enableZoom = true
				controls.autoRotate = true
				controls.autoRotateSpeed = -0.25

				// stats

				stats = new Stats()
				stats.domElement.style.position = "relative"
				stats.domElement.style.bottom = "0px"
				stats.domElement.style.zIndex = 100
				stats.domElement.style.display = "none"
				container.appendChild(stats.domElement)

				// light

				var light = new THREE.PointLight(0xffffff, 1, 0)
				light.position.set(0, 0, 900)
				var ambientLight = new THREE.AmbientLight(0x101030)
				scene.add(light)
			}

			// labels

			var spriteMap = new THREE.TextureLoader().load("toolkit/names/Jam.png")
			var spriteMaterial = new THREE.SpriteMaterial({ map: spriteMap })
			var spriteW = new THREE.Sprite(spriteMaterial)
			spriteW.scale.set(45, 21, 1)
			spriteW.position.set(162, 180, -180)

			var spriteMap = new THREE.TextureLoader().load("toolkit/names/Jam.png")
			var spriteMaterial = new THREE.SpriteMaterial({ map: spriteMap })
			var spriteW1 = new THREE.Sprite(spriteMaterial)
			spriteW1.scale.set(80, 80, 1)
			spriteW1.position.set(10, 10, 10)
			scene.add.spriteW1

			spriteW.userData = dataWimke
			spriteW1.userData = dataWimke

			var groupHover = new THREE.Group()
			groupHover.add(spriteW, spriteW1)
			scene.add(groupHover)

			groupHover.on(
				"hover",
				function(obj) {
					spriteHoverIn()
					$(`#hover-${obj.userData.id}`).show()
				},
				function(obj) {
					spriteHoverOut()
					$(`#hover-${obj.userData.id}`).hide()
				}
			)
			groupHover.on("click", function(obj) {
				window.location = obj.userData.url
			})

			// var geometry = new THREE.SphereGeometry(4, 32, 32)
			// for (var i = 0; i < 5; i++) {
			// 	var object = new THREE.Mesh(
			// 		geometry,
			// 		new THREE.MeshBasicMaterial({
			// 			shading: THREE.FlatShading,
			// 			color: 0x0000ee
			// 		})
			// 	)

			// 	console.log(object)
			// 	switch (i) {
			// 		case 0:
			// 			camera.add(object)
			// 			object.userData = {
			// 				URL: "https://www.are.na/external-pages/texts-fb-7tkfmn2k"
			// 			}
			// 			object.position.set(-195, 220, -10) //x, y, z
			// 			var spriteFeatures = makeTextSprite("")
			// 			spriteFeatures.position.set(-195, 220, -10)
			// 			scene.add(spriteFeatures)

			// 			break
			// 		case 1:
			// 			object.userData = {
			// 				URL: "https://www.are.na/external-pages/texts-fb-7tkfmn2k"
			// 			}
			// 			object.position.set(197, 170, -150)
			// 			var spriteContact = makeTextSprite("")
			// 			spriteContact.position.set(197, 170, -150)
			// 			scene.add(spriteContact)

			// 			break
			// 		case 2:
			// 			object.userData = {
			// 				URL: "https://www.are.na/external-pages/texts-fb-7tkfmn2k"
			// 			}
			// 			object.position.set(-205, -15, -130)
			// 			var spritesignup = makeTextSprite("")
			// 			spritesignup.position.set(-205, -15, -130)
			// 			scene.add(spritesignup)

			// 			break
			// 		case 3:
			// 			object.userData = {
			// 				URL: "https://www.are.na/external-pages/texts-fb-7tkfmn2k"
			// 			}
			// 			object.position.set(65, 70, 93)
			// 			var spriteAbout = makeTextSprite("")
			// 			spriteAbout.position.set(65, 70, 93)
			// 			scene.add(spriteAbout)

			// 			break
			// 		case 4:
			// 			object.userData = {
			// 				URL: "http://www.ursulakleguinarchive.com/Note-Technology.html"
			// 			}
			// 			object.position.set(175, -185, -100)
			// 			var spriteAbout = makeTextSprite("")
			// 			spriteAbout.position.set(175, -185, -100)
			// 			scene.add(spriteAbout)

			// 			break
			// 		case 5:
			// 			object.userData = {
			// 				URL: "http://www.ursulakleguinarchive.com/Note-Technology.html"
			// 			}
			// 			object.position.set(-65, -50, 100)
			// 			var spriteAbout = makeTextSprite("")
			// 			spriteAbout.position.set(-65, -50, 100)
			// 			scene.add(spriteAbout)

			// 			break
			// 		case 5:
			// 			object.userData = {
			// 				URL: "http://www.ursulakleguinarchive.com/Note-Technology.html"
			// 			}
			// 			object.position.set(40, 100, -50)
			// 			var spriteAbout = makeTextSprite("")
			// 			spriteAbout.position.set(40, 100, -50)
			// 			scene.add(spriteAbout)
			// 	}

			// 	scene.add(object)
			// 	objects.push(object)
			// }

			function onWindowResize() {
				camera.aspect = window.innerWidth / window.innerHeight
				camera.updateProjectionMatrix()
			}

			function onDocumentMouseDown(event) {
				// event.preventDefault()
				// var vector = new THREE.Vector3((event.clientX / window.innerWidth) * 2 - 1, -(event.clientY / window.innerHeight) * 2 + 1, 0.5)
				// projector.unprojectVector(vector, camera)
				// var raycaster = new THREE.Raycaster(camera.position, vector.sub(camera.position).normalize())
				// var intersects = raycaster.intersectObjects(objects)
				// if (intersects.length > 0) {
				// 	window.open(intersects[0].object.userData.URL, "_target")
				// 	intersects[0].object.material.color = new THREE.Color(0x551abb)
				// 	intersects[0].object.material.needsUpdate = true
				// }
			}

			// sprite styling

			// function makeTextSprite(message, parameters) {
			// 	if (parameters === undefined) parameters = {}
			// 	var fontface = parameters.hasOwnProperty("fontface") ? parameters["fontface"] : "Arial"
			// 	var fontsize = parameters.hasOwnProperty("fontsize") ? parameters["fontsize"] : 32
			// 	var borderThickness = parameters.hasOwnProperty("borderThickness") ? parameters["borderThickness"] : 1
			// 	var borderColor = parameters.hasOwnProperty("borderColor") ? parameters["borderColor"] : { r: 0, g: 0, b: 0, a: 1.0 }
			// 	var backgroundColor = parameters.hasOwnProperty("backgroundColor") ? parameters["backgroundColor"] : { r: 255, g: 255, b: 255, a: 1.0 }
			// 	var textColor = parameters.hasOwnProperty("textColor") ? parameters["textColor"] : { r: 0, g: 0, b: 0, a: 1.0 }

			// 	var canvas = document.createElement("canvas")
			// 	var context = canvas.getContext("2d")
			// 	context.font = fontsize + "px " + fontface
			// 	var metrics = context.measureText(message)
			// 	var textWidth = metrics.width

			// 	context.fillStyle = "rgba(" + backgroundColor.r + "," + backgroundColor.g + "," + backgroundColor.b + "," + backgroundColor.a + ")"
			// 	context.strokeStyle = "rgba(" + borderColor.r + "," + borderColor.g + "," + borderColor.b + "," + borderColor.a + ")"
			// 	context.lineWidth = borderThickness
			// 	context.fillStyle = "rgba(" + textColor.r + ", " + textColor.g + ", " + textColor.b + ", 1.0)"
			// 	context.fillText(message, borderThickness, fontsize + borderThickness)

			// 	var texture = new THREE.Texture(canvas)
			// 	texture.needsUpdate = true

			// 	var spriteMaterial = new THREE.SpriteMaterial({
			// 		map: texture,
			// 		useScreenCoordinates: false
			// 	})
			// 	var sprite = new THREE.Sprite(spriteMaterial)
			// 	sprite.scale.set(4 * fontsize, 2 * fontsize, 5 * fontsize)
			// 	return sprite
			// }

			function animate() {
				requestAnimationFrame(animate)
				render()
				update()
			}

			function update() {
				controls.update()
				stats.update()
			}

			function render() {
				renderer.render(scene, camera)
			}
		</script>

		<p><span id="Loader"></span></p>
	</body>
</html>
